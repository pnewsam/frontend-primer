---
import { isActivePage } from "../lib/utils";
import { toNavItems, type PageFrontmatter } from "../lib/pages";

// Glob all MDX files from each category
const fundamentalsPages = await Astro.glob<PageFrontmatter>("../pages/fundamentals/**/index.mdx");
  const topicsPages = await Astro.glob<PageFrontmatter>("../pages/topics/**/index.mdx");
  const applicationDevelopmentPages = await Astro.glob<PageFrontmatter>("../pages/application-development/**/index.mdx");
const practicalPages = await Astro.glob<PageFrontmatter>("../pages/practicals/**/index.mdx");

const pagesByCategory = {
  "Home": [{ url: "/", title: "Home" }],
  "Fundamentals": toNavItems(fundamentalsPages),
  "Topics": toNavItems(topicsPages),
  "Application Development": toNavItems(applicationDevelopmentPages),
  "Practicals": toNavItems(practicalPages),
};

const currentPath = Astro.url.pathname;
---

<div class:list={"py-10 md:py-20 sticky top-0 h-screen overflow-y-auto left-0 border-r border-neutral-200 pr-8 space-y-4"}>
  {
    Object.entries(pagesByCategory).map(([groupName, pages]) => (
        <p class="uppercase tracking-widest text-neutral-500 text-xs mb-2 px-2">{groupName}</p>
        <ul class="space-y-1 w-full">
          {
            pages.map((page) => {
              const active = isActivePage(currentPath, page.url);
              return (
                <li class="w-full">
                  <a
                    class:list={["block w-full px-2 py-1 border no-underline text-blue-500 text-sm font-sans transition-colors rounded-md", {
                      "bg-blue-400/10 border-blue-400/15": active,
                      "border-transparent hover:bg-blue-400/10 border-transparent": !active,
                    }]}
                    href={page.url}
                  >
                    {page.title}
                  </a>
                </li>
              );
            })
          }
        </ul>
    ))}
</div>
