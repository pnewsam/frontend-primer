---
import { isActivePage } from "../lib/utils";
import { toNavItems, type PageFrontmatter } from "../lib/pages";

// Glob all MDX files from each category
const conceptPages = await Astro.glob<PageFrontmatter>("../pages/concepts/**/index.mdx");
const topicPages = await Astro.glob<PageFrontmatter>("../pages/topics/**/index.mdx");
const practicalPages = await Astro.glob<PageFrontmatter>("../pages/practicals/**/index.mdx");
const applicationDevelopmentPages = await Astro.glob<PageFrontmatter>("../pages/application-development/**/index.mdx");

const pagesByCategory = {
  "Home": [{ url: "/", title: "Home" }],
  "Concepts": toNavItems(conceptPages),
  "Topics": toNavItems(topicPages),
  "Practicals": toNavItems(practicalPages),
  "Application Development": toNavItems(applicationDevelopmentPages),
};

const currentPath = Astro.url.pathname;
---

<div class:list={"py-10 md:py-20 sticky top-0 left-0 pr-4 space-y-4"}>
  {
    Object.entries(pagesByCategory).map(([groupName, pages]) => (
        <p class="uppercase tracking-widest text-neutral-500 text-xs mb-2">{groupName}</p>
        <ul class="space-y-1 w-full">
          {
            pages.map((page) => {
              const active = isActivePage(currentPath, page.url);
              return (
                <li class="w-full">
                  <a
                    class:list={["block w-full px-2 py-1 no-underline text-sm font-medium transition-colors rounded-md", {
                      "text-blue-700 bg-blue-50": active,
                      "text-blue-500 border-transparent hover:bg-blue-50 hover:text-blue-600": !active,
                    }]}
                    href={page.url}
                  >
                    {page.title}
                  </a>
                </li>
              );
            })
          }
        </ul>
    ))}
</div>
